"use strict";(self.webpackChunkspire=self.webpackChunkspire||[]).push([[933],{6933:(S,A,r)=>{r.r(A),r.d(A,{FillAcademicYearComponent:()=>U});var P=r(4755),h=r(1728),E=r(5326),T=r(4933),m=r(9401),g=r(9114),v=r(787),D=r(6737),i=r(8381),d=r(6012),u=r(7188),e=r(2223),n=r(4242),p=r(823),_=r(1217);function N(o,c){if(1&o&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&o){const t=c.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.program_Name," ")}}function f(o,c){if(1&o&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&o){const t=c.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.semester_Name," ")}}function C(o,c){if(1&o&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&o){const t=c.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.course_Name," ")}}function O(o,c){if(1&o&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&o){const t=c.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.applicationUser.fName+" "+t.applicationUser.lName," ")}}function I(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"mat-card",2)(1,"mat-card-content")(2,"form",3)(3,"mat-form-field",4)(4,"mat-label"),e._uU(5,"Programs"),e.qZA(),e.TgZ(6,"mat-select",5),e.NdJ("valueChange",function(l){e.CHM(t);const a=e.oxw();return e.KtG(a.SetCourses(l))}),e.YNc(7,N,2,2,"mat-option",6),e.qZA()(),e.TgZ(8,"mat-form-field",4)(9,"mat-label"),e._uU(10,"Semesters"),e.qZA(),e.TgZ(11,"mat-select",7),e.NdJ("valueChange",function(l){e.CHM(t);const a=e.oxw();return e.KtG(a.getCoursesAssignedInSemester(l))}),e.YNc(12,f,2,2,"mat-option",6),e.qZA()(),e.TgZ(13,"mat-form-field",4)(14,"mat-label"),e._uU(15,"Courses"),e.qZA(),e.TgZ(16,"mat-select",8),e.NdJ("valueChange",function(l){e.CHM(t);const a=e.oxw();return e.KtG(a.getProfessors(l))}),e.YNc(17,C,2,2,"mat-option",6),e.qZA()(),e.TgZ(18,"mat-form-field",4)(19,"mat-label"),e._uU(20,"Professor"),e.qZA(),e.TgZ(21,"mat-select",9),e.YNc(22,O,2,2,"mat-option",6),e.qZA()()(),e.TgZ(23,"button",10),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.AssignCourse())}),e._uU(24,"Assign course"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("ngForOf",t.AcademicPrograms),e.xp6(5),e.Q6J("ngForOf",t.Semesters),e.xp6(4),e.Q6J("disabled",0==t.AcademicProgramId),e.xp6(1),e.Q6J("ngForOf",t.Courses),e.xp6(4),e.Q6J("disabled",0==t.AcademicProgramId),e.xp6(1),e.Q6J("ngForOf",t.professors),e.xp6(1),e.Q6J("disabled",t.form.invalid)}}const M=function(){return["Home"]};let U=(()=>{class o{constructor(t,s,l,a,F){this.fb=t,this.AcademicProgService=s,this.SemesterService=l,this.ProfessorService=a,this.SwalService=F,this.dataSource=[],this.AcademicPrograms=[],this.Semesters=[],this.Courses=[],this.displayedColumnsForGeneric=[{propertyName:"course_Name",ColumnName:"Course"},{propertyName:"semester_Name",ColumnName:"Semester"},{propertyName:"professor_Name",ColumnName:"Professor"}],this.errorStateMatcher=new D.o,this.professors=[],this.AcademicProgramId=0,this.form=this.fb.group({professorId:[null,m.kI.required],courseId:[null,m.kI.required],semesterId:[null,m.kI.required]})}ngOnInit(){(0,u.$)(this.AcademicProgService.getAll(i.c0.getAll),this.SemesterService.getAll(i.KG.getAll)).subscribe(([t,s])=>{this.AcademicPrograms=t,this.Semesters=s.filter(l=>new Date(l.start_Date).getFullYear()>=(new Date).getFullYear())})}Delete(t){t.swalResponse&&this.ProfessorService.Delete(i.NY.RemoveCourseFromProfessorInSemester,t.element.id).subscribe({next:s=>{this.getCoursesAssignedInSemester(this.form.value.semesterId),this.SwalService.Success()},error:s=>{this.SwalService.Fail()}})}AssignCourse(){this.ProfessorService.add(i.NY.AssignCourseToProfessorInSemester,this.form.value).subscribe(t=>{this.getCoursesAssignedInSemester(this.form.value.semesterId)})}SetCourses(t){this.AcademicProgramId=t,this.Courses=this.AcademicPrograms.filter(s=>s.id==t)[0].coursePrograms.map(s=>s.course)}getProfessors(t){let s=this.dataSource.map(a=>a.course_Name).join(","),l=this.Courses.filter(a=>a.id==t)[0];s.includes(l.course_Name)?this.SwalService.Fail("This Course is already assigned to this semester"):this.ProfessorService.GetById(i.NY.GetProfessorsByCourseId,t).subscribe(a=>{this.professors=a})}getCoursesAssignedInSemester(t){this.ProfessorService.GetById(i.NY.GetCoursesAssignedToProfessorsBySemester,t).subscribe(s=>{let l=[];s.forEach(a=>{l.push({id:a.id,course_Name:a.course.course_Name,semester_Name:a.semester.semester_Name,professor_Name:a.professor.applicationUser.fName+" "+a.professor.applicationUser.lName})}),this.dataSource=l})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m.qu),e.Y36(n.v),e.Y36(n.v),e.Y36(n.v),e.Y36(p.J))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-fill-academic-year"]],standalone:!0,features:[e.jDz],decls:3,vars:8,consts:[["BreadCrumbTitle","AcademicProgram",3,"dataSource","ColumnDefs","BreadCrumbActive_item","BreadCrumbItems","UseEditButton","UseAddNewButton","outsideTemplate","OnDeleteClick"],["FormDesignAboveTable",""],[1,"mb-2"],[1,"row",3,"formGroup"],["appearance","outline",1,"col-md-6","mb-2"],[3,"valueChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","semesterId",3,"valueChange"],["formControlName","courseId",3,"disabled","valueChange"],["formControlName","professorId",3,"disabled"],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(t,s){if(1&t&&(e.TgZ(0,"my-table",0),e.NdJ("OnDeleteClick",function(a){return s.Delete(a)}),e.qZA(),e.YNc(1,I,25,8,"ng-template",null,1,e.W1O)),2&t){const l=e.MAs(2);e.Q6J("dataSource",s.dataSource)("ColumnDefs",s.displayedColumnsForGeneric)("BreadCrumbActive_item","AcademicProgram")("BreadCrumbItems",e.DdM(7,M))("UseEditButton",!1)("UseAddNewButton",!1)("outsideTemplate",l)}},dependencies:[P.ax,T.bC,g.lN,g.KE,g.hX,v.LD,v.gD,_.ey,d.QW,d.a8,d.dn,h.ot,h.lW,E.ii,m.UX,m._Y,m.JJ,m.JL,m.sg,m.u,m.u5],encapsulation:2}),o})()},7188:(S,A,r)=>{r.d(A,{$:()=>D});var P=r(9751),h=r(8421);const{isArray:E}=Array;var m=r(515),g=r(5403),v=r(3269);function D(...i){const d=(0,v.jO)(i),u=function T(i){return 1===i.length&&E(i[0])?i[0]:i}(i);return u.length?new P.y(e=>{let n=u.map(()=>[]),p=u.map(()=>!1);e.add(()=>{n=p=null});for(let _=0;!e.closed&&_<u.length;_++)(0,h.Xf)(u[_]).subscribe((0,g.x)(e,N=>{if(n[_].push(N),n.every(f=>f.length)){const f=n.map(C=>C.shift());e.next(d?d(...f):f),n.some((C,O)=>!C.length&&p[O])&&e.complete()}},()=>{p[_]=!0,!n[_].length&&e.complete()}));return()=>{n=p=null}}):m.E}}}]);